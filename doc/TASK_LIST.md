# 电影搜索应用 - 开发任务清单 (V2 - 单页版)

本文档根据PRD V2.0(单页版)将开发工作分解为可执行的小任务。

---

### 阶段一 & 二 & 三：核心功能 (已完成)
- MVP版本的基础布局、核心搜索、状态管理和UI样式已全部完成。

---

### 阶段四：单页视图切换与电影详情 (预计总耗时: 3小时)

> **技术核心**: 这个阶段我们将在`App`组件中使用State来管理当前应该显示哪个视图（列表 vs 详情），这是单页应用的核心逻辑。

- **任务 4.1: 实现视图管理State (约30分钟)**已完成
  - **目标**: 在`App.jsx`中创建一个State，用于决定当前是显示电影列表还是电影详情。
  - **验收标准**: `App.jsx`中有一个名为`selectedMovie`的state，初始值为`null`。

- **任务 4.2: 创建电影详情视图组件 (约60分钟)**已完成
  - **目标**: 创建`src/components/MovieDetails.jsx`组件，负责展示单个电影的详细信息。
  - **验收标准**: 组件能接收电影数据和一个"返回"函数作为`props`，并渲染出详情页的静态UI（包含一个返回按钮）。

- **任务 4.3: 实现条件渲染 (约30分钟)**已完成
  - **目标**: 根据`selectedMovie`的state来切换`MovieList`和`MovieDetails`视图。
  - **验收标准**: 当`selectedMovie`为`null`时，显示`MovieList`；当它有值时，显示`MovieDetails`。

- **任务 4.4: 改造`MovieCard`以切换视图 (约30分钟)**已完成
  - **目标**: 让电影卡片可以被点击，并触发视图切换。
  - **验收标准**: 点击`MovieCard`后，`App`组件的`selectedMovie`状态被更新为该电影的ID，并触发`MovieDetails`视图的显示。

- **任务 4.5: 实现详情视图数据获取 (约30分钟)**已完成
  - **目标**: 让`MovieDetails`组件能展示动态获取的数据。
  - **验收标准**: 当`selectedMovie`状态变化时，`App`组件根据其ID获取电影详情，并将完整的电影对象传递给`MovieDetails`组件。

---

### 阶段五：分页与数据持久化 (预计总耗时: 3小时)

> **技术核心**: 这个阶段我们将使用浏览器的`localStorage`来实现一个轻量级的"待看清单"功能。

- **任务 5.1: 实现"加载更多"功能 (约60分钟)**已完成
  - **目标**: 在搜索结果列表底部实现分页加载。
  - **验收标准**: 当搜索结果多于一页时，列表底部出现"加载更多"按钮；点击后，能将第二页的结果追加到现有列表中。

- **任务 5.2: 创建`localStorage`服务 (约30分钟)**已完成
  - **目标**: 封装对`localStorage`的读写操作，便于管理待看清单。
  - **验收标准**: 创建`src/services/storage.js`，包含`getWatchlist`、`addToWatchlist`、`removeFromWatchlist`等函数。

- **任务 5.3: 添加"收藏"功能 (约60分钟)**
  - **目标**: 在`MovieDetails`视图上实现添加/移除待看清单的功能。
  - **验收标准**: 详情视图上有一个按钮，点击可以收藏或取消收藏电影，状态会同步到`localStorage`。

- **任务 5.4: 实现待看清单视图 (约30分钟)**
  - **目标**: 在`App.jsx`的`header`中添加一个按钮，用于切换显示"所有电影"和"我的收藏"。
  - **验收标准**: 点击"我的收藏"按钮后，`MovieList`组件会从`localStorage`获取数据并渲染。

---

### 阶段六：体验优化 (预计总耗时: 1小时)

- **任务 6.1: 实现热门电影推荐 (约60分钟)**已完成
  - **目标**: 在应用初次加载时，默认展示热门电影列表。
  - **验收标准**: 打开应用时，不再是空白提示，而是直接调用API获取热门电影并展示。

### 阶段七：进阶状态管理与代码优化（预计总耗时：1.5小时）

> **技术核心**：本阶段将用 useReducer 替代 useState 或 localStorage 的直接操作，集中管理"待看清单"状态，并为后续引入 Context 做准备。

- **任务 7.1: 设计 Watchlist Reducer（约20分钟）**
  - **目标**：在 `src/hooks` 目录下创建 `watchlistReducer.js`，定义 reducer 逻辑，支持添加、移除、清空等操作。
  - **验收标准**：reducer 能正确处理 `ADD`、`REMOVE`、`CLEAR` 等 action，返回新的待看清单数组。

- **任务 7.2: 在组件中用 useReducer 替换 useState（约20分钟）**
  - **目标**：在管理"待看清单"的组件（如 App.jsx 或 Watchlist 相关组件）中，用 useReducer 替换 useState。
  - **验收标准**：所有对"待看清单"的操作都通过 dispatch 分发 action，状态更新逻辑集中在 reducer。

- **任务 7.3: 同步 localStorage（约20分钟）**
  - **目标**：在 useReducer 的副作用中（如 useEffect），实现"待看清单"与 localStorage 的同步，保证刷新页面后数据不丢失。
  - **验收标准**：添加/移除/清空待看清单后，localStorage 中的数据同步更新。

- **任务 7.4: 组件交互与 UI 测试（约30分钟）**
  - **目标**：确保 MovieDetails、MovieList 等组件通过 dispatch 正确操作"待看清单"，并在 UI 上实时反映状态变化。
  - **验收标准**：添加、移除、清空操作在界面和 localStorage 中都能正确生效。

 